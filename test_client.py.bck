from soda_cloud_client import SodaCloudClient
from pprint import pprint
import logging


if __name__ == "__main__":

    logging.basicConfig()
    logger = logging.getLogger("test")
    logger.setLevel(logging.INFO)

    c = SodaCloudClient(
        api_base_url="https://cloud.soda.io",
        username="a5ffba63-6e73-49f0-a8ca-4fc08b99a609",
        password="f4wGP0tdBWXCOAeI58T4nSMgG0fIVh3uu4CYHv5hkMUy8zbYHwv4fg",
        logger=logger,
        wait_secs_between_api_calls=None

    )

    scan_id = c.trigger_scan(scan_name="playground_default_scan", data_timestamp=None)
    #scan_status = c.get_scan_status(scan_id=scan_id)
    #pprint(scan_status)
    scan_logs = c.get_scan_logs(scan_id=scan_id)
    pprint(scan_logs)